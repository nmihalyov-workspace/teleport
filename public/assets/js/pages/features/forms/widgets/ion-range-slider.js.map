{"version":3,"names":[],"mappings":"","sources":["features/forms/widgets/ion-range-slider.js"],"sourcesContent":["// Class definition\r\n\r\nvar KTIONRangeSlider = function () {\r\n\r\n    // Private functions\r\n    var ionSlider = function () {\r\n        var $wishPercent = $('[data-name=\"wish-percent\"]');\r\n        var $wishCommission = $('[data-name=\"wish-commission\"]');\r\n        var $commission = $('[data-name=\"commission\"]');\r\n        var $percent = $('[data-name=\"percent\"]');\r\n        var $comissionSlider = $('#comission_slider');\r\n        var $btnSetTariff = $('[data-name=\"set-tariff\"]');\r\n\r\n        $comissionSlider.ionRangeSlider({\r\n            skin: \"round\",\r\n            grid: true,\r\n            hide_min_max: true,\r\n            min: 0,\r\n            max: 70,\r\n            from: 30,\r\n            prettify: my_prettify,\r\n            onStart: calculate,\r\n            onFinish: calculate,\r\n            onUpdate: calculate,\r\n            onChange: calculate\r\n        });\r\n\r\n\r\n        // TODO заглушка\r\n        function f(n) { // прямая\r\n            return (Math.PI + n) * (100 + n * n / 6);\r\n        }\r\n\r\n        function f2(result) { // обратная\r\n            for (var idx = 0; idx <= 70; idx++) {\r\n                if (f(idx) < result && result <= f(idx + 1)) {\r\n                    return idx;\r\n                }\r\n            }\r\n            return 0;\r\n        }\r\n\r\n        function my_prettify (n) {\r\n            var num = f(n + 1);\r\n            return n + \"%, \" + (n ? (num).toFixed(2) : '0') + \" ₽\";\r\n        }\r\n\r\n        function calculate(n) {\r\n            var num = f(n.from + 1);\r\n\r\n            $commission.text((n.from ? (num).toFixed(2) : '0'));\r\n            $percent.val(n.from);\r\n\r\n            $wishCommission.val((11587 + (n.from ? +num : 0)).toFixed(2));\r\n            $wishPercent.text((2.73 + (n.from / 10)).toFixed(2));\r\n        }\r\n\r\n        function sync() {\r\n            var val = $(this).val();\r\n            var myRange = $comissionSlider.data(\"ionRangeSlider\");\r\n            myRange.update({\r\n                from: parseInt(val)\r\n            });\r\n        }\r\n\r\n        function sync2() {\r\n            var val = parseInt($(this).cleanVal() / 100) - 11587;\r\n            var myRange = $comissionSlider.data(\"ionRangeSlider\");\r\n            myRange.update({\r\n                from: f2(parseInt(val))\r\n            });\r\n        }\r\n\r\n        $percent.on('keyup', sync).on('keydown', sync);\r\n        $wishCommission.on('change', sync2)/*.on('keydown', sync2)*/;\r\n\r\n        $btnSetTariff.on('click', function () {\r\n            var myRange = $comissionSlider.data(\"ionRangeSlider\");\r\n            myRange.update({\r\n                from: 0\r\n            });\r\n        });\r\n    }\r\n\r\n    return {\r\n        // public functions\r\n        init: function() {\r\n            ionSlider();\r\n        }\r\n    };\r\n}();\r\n\r\njQuery(document).ready(function() {\r\n    KTIONRangeSlider.init();\r\n});\r\n\r\n\r\n"],"file":"ion-range-slider.js"}